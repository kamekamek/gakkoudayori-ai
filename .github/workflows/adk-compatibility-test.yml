name: ğŸ¤– ADKäº’æ›æ€§ãƒ†ã‚¹ãƒˆ

on:
  push:
    branches: [ main, develop, feature/remake-agent ]
    paths:
      - 'backend/agents/**'
      - 'backend/test_adk_compatibility.py'
      - 'backend/pyproject.toml'
  pull_request:
    branches: [ main, develop ]
    paths:
      - 'backend/agents/**'
      - 'backend/test_adk_compatibility.py'
      - 'backend/pyproject.toml'

jobs:
  adk-compatibility-test:
    runs-on: ubuntu-latest
    name: ADK v1.0.0 äº’æ›æ€§ãƒ†ã‚¹ãƒˆ
    
    steps:
    - name: ğŸ“¥ ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ
      uses: actions/checkout@v4
      
    - name: ğŸ Python 3.11ã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
      uses: actions/setup-python@v4
      with:
        python-version: '3.11'
        
    - name: ğŸ“¦ uv ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
      run: pip install uv
        
    - name: ğŸ”§ uvä¾å­˜é–¢ä¿‚ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
      working-directory: ./backend
      run: |
        uv sync --extra dev
        
    - name: ğŸ¤– ADKäº’æ›æ€§ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œ
      working-directory: ./backend
      run: |
        uv run python test_uv_migration.py
        
    - name: ğŸ“‹ ãƒ†ã‚¹ãƒˆçµæœã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
      if: always()
      uses: actions/upload-artifact@v3
      with:
        name: adk-test-results
        path: |
          /tmp/adk_artifacts/
        retention-days: 5
        
    - name: ğŸ“Š ãƒ†ã‚¹ãƒˆå¤±æ•—æ™‚ã®è©³ç´°æƒ…å ±
      if: failure()
      run: |
        echo "ADKäº’æ›æ€§ãƒ†ã‚¹ãƒˆãŒå¤±æ•—ã—ã¾ã—ãŸã€‚ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š"
        echo "1. ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®æ­£ã—ã„åˆæœŸåŒ–"
        echo "2. root_agentå¤‰æ•°ã®å­˜åœ¨"  
        echo "3. SequentialAgentã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä»•æ§˜"
        echo "4. InvocationContextã®ãƒ¡ã‚½ãƒƒãƒ‰å¤‰æ›´"
        echo "5. ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆç®¡ç†ã®å®Ÿè£…" 