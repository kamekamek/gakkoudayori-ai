<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TinyMCE ãƒ†ã‚¹ãƒˆ</title>
    
    <!-- TinyMCE CDN -->
    <script src="https://cdn.jsdelivr.net/npm/tinymce@6.8.3/tinymce.min.js"></script>
    
    <style>
        body {
            margin: 20px;
            font-family: Arial, sans-serif;
        }
        .status {
            padding: 10px;
            margin: 10px 0;
            border-radius: 4px;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>ğŸ§ª TinyMCE èª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆ</h1>
    
    <div id="status" class="status info">
        ğŸ“‹ TinyMCEãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’èª­ã¿è¾¼ã¿ä¸­...
    </div>
    
    <textarea id="test-editor">
        <h1>ãƒ†ã‚¹ãƒˆã‚¨ãƒ‡ã‚£ã‚¿</h1>
        <p>ã“ã‚Œã¯TinyMCEã®ãƒ†ã‚¹ãƒˆã§ã™ã€‚</p>
    </textarea>
    
    <script>
        const statusDiv = document.getElementById('status');
        
        // TinyMCEèª­ã¿è¾¼ã¿ç¢ºèª
        console.log('ğŸš€ ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸é–‹å§‹');
        console.log('TinyMCE:', typeof tinymce);
        
        if (typeof tinymce === 'undefined') {
            statusDiv.className = 'status error';
            statusDiv.innerHTML = 'âŒ TinyMCEãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ';
            console.error('TinyMCEæœªå®šç¾©');
        } else {
            statusDiv.className = 'status success';
            statusDiv.innerHTML = 'âœ… TinyMCEãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿æˆåŠŸï¼åˆæœŸåŒ–ã‚’é–‹å§‹ã—ã¾ã™...';
            console.log('TinyMCEèª­ã¿è¾¼ã¿æˆåŠŸ');
            
            // ç°¡å˜ãªåˆæœŸåŒ–ãƒ†ã‚¹ãƒˆ
            tinymce.init({
                selector: '#test-editor',
                height: 300,
                menubar: false,
                plugins: ['lists', 'link'],
                toolbar: 'undo redo | bold italic | bullist numlist',
                
                setup: function(editor) {
                    console.log('ã‚¨ãƒ‡ã‚£ã‚¿ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—é–‹å§‹');
                },
                
                init_instance_callback: function(editor) {
                    console.log('âœ… ã‚¨ãƒ‡ã‚£ã‚¿åˆæœŸåŒ–å®Œäº†');
                    statusDiv.innerHTML = 'ğŸ‰ TinyMCEã‚¨ãƒ‡ã‚£ã‚¿ãŒæ­£å¸¸ã«åˆæœŸåŒ–ã•ã‚Œã¾ã—ãŸï¼';
                    
                    // Flutterè¦ªãƒ•ãƒ¬ãƒ¼ãƒ ã«ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
                    if (window.parent && window.parent.postMessage) {
                        window.parent.postMessage({
                            type: 'tinymce_ready',
                            data: { status: 'ready' }
                        }, '*');
                        console.log('Flutterå´ã«æº–å‚™å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡');
                    }
                }
            }).then(function(editors) {
                console.log('åˆæœŸåŒ–PromiseæˆåŠŸ:', editors.length);
            }).catch(function(error) {
                console.error('åˆæœŸåŒ–Promiseå¤±æ•—:', error);
                statusDiv.className = 'status error';
                statusDiv.innerHTML = 'âŒ ã‚¨ãƒ‡ã‚£ã‚¿ã®åˆæœŸåŒ–ã«å¤±æ•—: ' + error.message;
            });
        }
    </script>
</body>
</html>