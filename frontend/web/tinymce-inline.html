<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>TinyMCE Editor</title>
    <script src="https://cdn.jsdelivr.net/npm/tinymce@6.8.3/tinymce.min.js"></script>
</head>
<body style="margin:0;padding:10px;font-family:Arial,sans-serif;">
    <div id="status" style="text-align:center;padding:20px;color:#666;">
        ğŸ“ ã‚¨ãƒ‡ã‚£ã‚¿ã‚’èª­ã¿è¾¼ã¿ä¸­...
    </div>
    
    <textarea id="editor">
        <h1>ğŸŒ¸ å­¦ç´šé€šä¿¡ ğŸŒ¸</h1>
        <p>ã“ã‚“ã«ã¡ã¯ã€ä¿è­·è€…ã®çš†æ§˜ã€‚</p>
        <p>ä»Šæ—¥ã¯ç´ æ™´ã‚‰ã—ã„ä¸€æ—¥ã§ã—ãŸã€‚</p>
    </textarea>

    <script>
        console.log('ğŸš€ TinyMCE inline é–‹å§‹');
        
        if (typeof tinymce === 'undefined') {
            document.getElementById('status').innerHTML = 'âŒ TinyMCEèª­ã¿è¾¼ã¿å¤±æ•—';
            console.error('TinyMCEæœªå®šç¾©');
        } else {
            console.log('âœ… TinyMCEèª­ã¿è¾¼ã¿æˆåŠŸ');
            document.getElementById('status').innerHTML = 'âœ… TinyMCEèª­ã¿è¾¼ã¿æˆåŠŸã€åˆæœŸåŒ–ä¸­...';
            
            tinymce.init({
                selector: '#editor',
                height: 400,
                menubar: false,
                plugins: ['lists', 'link', 'paste'],
                toolbar: 'undo redo | bold italic | bullist numlist | link',
                paste_as_text: true,
                
                init_instance_callback: function(editor) {
                    console.log('âœ… TinyMCEåˆæœŸåŒ–å®Œäº†');
                    document.getElementById('status').style.display = 'none';
                    
                    // Flutterå´ã«é€šçŸ¥
                    if (window.parent && window.parent.postMessage) {
                        window.parent.postMessage({
                            type: 'tinymce_ready',
                            data: { status: 'ready' }
                        }, '*');
                    }
                }
            }).catch(function(error) {
                console.error('TinyMCEåˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼:', error);
                document.getElementById('status').innerHTML = 'âŒ åˆæœŸåŒ–å¤±æ•—: ' + error.message;
            });
        }
        
        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡
        window.addEventListener('message', function(event) {
            try {
                const message = typeof event.data === 'string' ? JSON.parse(event.data) : event.data;
                
                if (message.type === 'set_content' && tinymce.activeEditor) {
                    tinymce.activeEditor.setContent(message.data.html || '');
                }
            } catch (e) {
                console.error('ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒ©ãƒ¼:', e);
            }
        });
    </script>
</body>
</html>