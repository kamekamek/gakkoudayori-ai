<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <title>å­¦ç´šé€šä¿¡ã‚¨ãƒ‡ã‚£ã‚¿ - Quill.js</title>
    
    <!-- Quill.js 2.0.0 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/quill@2.0.0/dist/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/quill@2.0.0/dist/quill.js"></script>
    
    <style>
        /* å­¦æ ¡å‘ã‘ã‚·ãƒ³ãƒ—ãƒ«ã‚¹ã‚¿ã‚¤ãƒ« */
        body {
            font-family: 'Hiragino Sans', 'Yu Gothic', sans-serif;
            margin: 0;
            padding: 16px;
            background-color: #f8f9fa;
        }
        
        /* ã‚¨ãƒ‡ã‚£ã‚¿ã‚³ãƒ³ãƒ†ãƒŠ */
        .editor-container {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* ã‚¹ãƒãƒ›å¯¾å¿œ */
        @media (max-width: 768px) {
            body {
                padding: 4px;
                margin: 0;
            }
            
            .editor-container {
                border-radius: 4px;
                max-width: 100%;
                margin: 0;
            }
            
            .ql-toolbar {
                padding: 6px 8px;
                flex-wrap: wrap;
                font-size: 14px;
            }
            
            .ql-toolbar .ql-formats {
                margin-right: 8px;
                margin-bottom: 4px;
            }
            
            .ql-toolbar button {
                width: 28px !important;
                height: 28px !important;
            }
            
            .ql-toolbar .ql-picker {
                font-size: 12px;
            }
            
            .ql-editor {
                padding: 12px;
                font-size: 14px; /* ã‚¹ãƒãƒ›ã§èª­ã¿ã‚„ã™ã„ã‚µã‚¤ã‚º */
                line-height: 1.6;
                min-height: 300px; /* ã‚¹ãƒãƒ›ã§ã¯ä½ã‚ã«è¨­å®š */
                max-height: 400px;
            }
            
            .control-panel {
                padding: 8px;
            }
            
            .control-panel button {
                padding: 8px 12px;
                margin: 2px;
                font-size: 12px;
                min-height: 40px; /* ã‚¿ãƒƒãƒã—ã‚„ã™ã„ã‚µã‚¤ã‚º */
                border-radius: 6px;
            }
            
            .theme-selector {
                margin-bottom: 8px;
            }
            
            .theme-button {
                width: 36px;
                height: 36px;
                margin: 0 3px;
            }
            
            .status-panel {
                padding: 6px 12px;
                font-size: 11px;
            }
        }
        
        /* ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º */
        .ql-toolbar {
            border-bottom: 1px solid #e0e0e0;
            padding: 12px 16px;
            background-color: #f5f5f5;
        }
        
        .ql-toolbar .ql-formats {
            margin-right: 16px;
        }
        
        /* ã‚¨ãƒ‡ã‚£ã‚¿æœ¬ä½“ */
        .ql-container {
            font-size: 14px;
            line-height: 1.6;
            border: none;
        }
        
        .ql-editor {
            padding: 20px;
            min-height: 400px;
            max-height: 600px;
            overflow-y: auto;
        }
        
        /* å­£ç¯€ãƒ†ãƒ¼ãƒè‰²è¨­å®š */
        .spring-theme {
            --primary-color: #ff6b6b;
            --secondary-color: #4ecdc4;
            --accent-color: #45b7d1;
        }
        
        .summer-theme {
            --primary-color: #feca57;
            --secondary-color: #48dbfb;
            --accent-color: #0abde3;
        }
        
        .autumn-theme {
            --primary-color: #ff9ff3;
            --secondary-color: #54a0ff;
            --accent-color: #5f27cd;
        }
        
        .winter-theme {
            --primary-color: #00d2d3;
            --secondary-color: #ff9f43;
            --accent-color: #ee5a24;
        }
        
        /* è¦‹å‡ºã—ã‚¹ã‚¿ã‚¤ãƒ« */
        .ql-editor h1 {
            color: var(--primary-color, #2c3e50);
            border-bottom: 2px solid var(--primary-color, #3498db);
            padding-bottom: 8px;
        }
        
        .ql-editor h2 {
            color: var(--secondary-color, #2c3e50);
            margin-top: 24px;
        }
        
        .ql-editor h3 {
            color: var(--accent-color, #2c3e50);
            margin-top: 20px;
        }
        
        /* ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ« */
        .control-panel {
            padding: 16px;
            background-color: #f0f0f0;
            border-top: 1px solid #e0e0e0;
            text-align: center;
        }
        
        .control-panel button {
            margin: 0 8px;
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            background-color: #007bff;
            color: white;
            cursor: pointer;
            font-size: 12px;
            font-weight: bold;
        }
        
        .control-panel button:hover {
            background-color: #0056b3;
        }
        
        .control-panel button:disabled {
            background-color: #6c757d;
            cursor: not-allowed;
        }
        
        /* å­£ç¯€ãƒ†ãƒ¼ãƒé¸æŠ */
        .theme-selector {
            margin-bottom: 16px;
            text-align: center;
        }
        
        .theme-button {
            display: inline-block;
            width: 40px;
            height: 40px;
            margin: 0 8px;
            border: 3px solid #ddd;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .theme-button.spring {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
        }
        
        .theme-button.summer {
            background: linear-gradient(45deg, #feca57, #48dbfb);
        }
        
        .theme-button.autumn {
            background: linear-gradient(45deg, #ff9ff3, #54a0ff);
        }
        
        .theme-button.winter {
            background: linear-gradient(45deg, #00d2d3, #ff9f43);
        }
        
        .theme-button.active {
            border-color: #007bff;
            transform: scale(1.1);
        }
        
        /* ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º */
        .status-panel {
            padding: 8px 16px;
            background-color: #e7f3ff;
            border-top: 1px solid #bee5eb;
            font-size: 12px;
            color: #0c5460;
            text-align: center;
        }

        /* ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—è¦–è¦šåŠ¹æœ */
        .ql-editor.drag-over {
            border: 2px dashed #007bff !important;
            background-color: rgba(0, 123, 255, 0.1) !important;
        }

        /* ç”»åƒã®ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–è¡¨ç¤º */
        .ql-editor img {
            max-width: 100%;
            height: auto;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin: 4px 0;
        }

        /* ã‚¹ãƒãƒ›ã§ã®ç”»åƒè¡¨ç¤ºæœ€é©åŒ– */
        @media (max-width: 768px) {
            .ql-editor img {
                max-width: 100%;
                height: auto;
                border-radius: 2px;
                margin: 2px 0;
            }
        }
    </style>
</head>
<body>
    <!-- å­£ç¯€ãƒ†ãƒ¼ãƒé¸æŠ -->
    <div class="theme-selector">
        <div class="theme-button spring active" data-theme="spring" title="æ˜¥ãƒ†ãƒ¼ãƒ"></div>
        <div class="theme-button summer" data-theme="summer" title="å¤ãƒ†ãƒ¼ãƒ"></div>
        <div class="theme-button autumn" data-theme="autumn" title="ç§‹ãƒ†ãƒ¼ãƒ"></div>
        <div class="theme-button winter" data-theme="winter" title="å†¬ãƒ†ãƒ¼ãƒ"></div>
    </div>
    
    <!-- ã‚¨ãƒ‡ã‚£ã‚¿ -->
    <div class="editor-container spring-theme" id="editor-container">
        <div id="quill-editor"></div>
        
        <!-- ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ« -->
        <div class="control-panel">
            <button onclick="getHtmlContent()">ğŸ“„ HTMLå–å¾—</button>
            <button onclick="getDeltaContent()">ğŸ“ Deltaå–å¾—</button>
            <button onclick="setContent()">ğŸ“¥ å†…å®¹è¨­å®š</button>
            <button onclick="clearContent()">ğŸ—‘ï¸ ã‚¯ãƒªã‚¢</button>
            <button onclick="exportPdf()">ğŸ“„ PDFå‡ºåŠ›</button>
        </div>
        
        <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹è¡¨ç¤º -->
        <div class="status-panel" id="status">
            âœ… Quill.js ã‚¨ãƒ‡ã‚£ã‚¿æº–å‚™å®Œäº† - å­¦ç´šé€šä¿¡ã‚’ç·¨é›†ã—ã¦ãã ã•ã„
        </div>
    </div>

    <script>
        // Quill.js åˆæœŸåŒ–ï¼ˆå­¦æ ¡å‘ã‘ã‚·ãƒ³ãƒ—ãƒ«è¨­å®šï¼‰
        const toolbarOptions = [
            // è¦‹å‡ºã—
            [{ 'header': [1, 2, 3, false] }],
            
            // åŸºæœ¬æ›¸å¼
            ['bold', 'italic', 'underline'],
            
            // ãƒªã‚¹ãƒˆ
            [{ 'list': 'ordered'}, { 'list': 'bullet' }],
            
            // ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆ
            [{ 'indent': '-1'}, { 'indent': '+1' }],
            
            // ãƒ†ã‚­ã‚¹ãƒˆé…ç½®
            [{ 'align': [] }],
            
            // ç”»åƒæŒ¿å…¥
            ['image'],
            
            // è‰²è¨­å®šï¼ˆã‚·ãƒ³ãƒ—ãƒ«ï¼‰
            [{ 'color': ['#000000', '#e60000', '#ff9900', '#ffff00', '#008a00', '#0066cc', '#9933ff'] }],
            [{ 'background': ['#ffffff', '#ffeaa7', '#fab1a0', '#fd79a8', '#fdcb6e', '#55a3ff', '#a29bfe'] }],
            
            // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
            ['clean']
        ];

        // ç”»åƒãƒãƒ³ãƒ‰ãƒ©ãƒ¼é–¢æ•°
        function imageHandler() {
            // Flutterå´ã«ç”»åƒæŒ¿å…¥è¦æ±‚ã‚’é€ä¿¡
            try {
                window.parent.postMessage({
                    type: 'REQUEST_IMAGE_INSERT'
                }, '*');
                updateStatus('ğŸ“· ç”»åƒé¸æŠãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’é–‹ã„ã¦ã„ã¾ã™...');
            } catch (e) {
                console.log('âŒ [QuillBridge] ç”»åƒæŒ¿å…¥è¦æ±‚ã‚¨ãƒ©ãƒ¼:', e);
                updateStatus('âŒ ç”»åƒæŒ¿å…¥è¦æ±‚ã«å¤±æ•—ã—ã¾ã—ãŸ');
            }
        }

        // Quill.js ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
        const quill = new Quill('#quill-editor', {
            theme: 'snow',
            modules: {
                toolbar: {
                    container: toolbarOptions,
                    handlers: {
                        image: imageHandler  // ã‚«ã‚¹ã‚¿ãƒ ç”»åƒãƒãƒ³ãƒ‰ãƒ©ãƒ¼
                    }
                }
            },
            placeholder: 'å­¦ç´šé€šä¿¡ã®å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„...\n\nä¾‹ï¼š\nâ–  ä»Šæ—¥ã®æ´»å‹•\nãƒ»é‹å‹•ä¼šã®ç·´ç¿’ã‚’ã—ã¾ã—ãŸ\nãƒ»ç®—æ•°ã®æˆæ¥­ã§ã¯æ›ã‘ç®—ã‚’å­¦ç¿’ã—ã¾ã—ãŸ\n\nâ–  ãŠçŸ¥ã‚‰ã›\nãƒ»æ˜æ—¥ã¯ä½“æ“æœã‚’å¿˜ã‚Œãšã«æŒå‚ã—ã¦ãã ã•ã„'
        });

        // å­£ç¯€ãƒ†ãƒ¼ãƒç®¡ç†
        let currentTheme = 'spring';
        
        // å­£ç¯€ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ
        document.querySelectorAll('.theme-button').forEach(button => {
            button.addEventListener('click', function() {
                const theme = this.dataset.theme;
                switchTheme(theme);
            });
        });
        
        function switchTheme(theme) {
            // å‰ã®ãƒ†ãƒ¼ãƒã‚¯ãƒ©ã‚¹ã‚’å‰Šé™¤
            const container = document.getElementById('editor-container');
            container.className = 'editor-container ' + theme + '-theme';
            
            // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ã‚’æ›´æ–°
            document.querySelectorAll('.theme-button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-theme="${theme}"]`).classList.add('active');
            
            currentTheme = theme;
            updateStatus(`ãƒ†ãƒ¼ãƒã‚’ã€Œ${getThemeName(theme)}ã€ã«å¤‰æ›´ã—ã¾ã—ãŸ`);
        }
        
        function getThemeName(theme) {
            const names = {
                'spring': 'æ˜¥',
                'summer': 'å¤', 
                'autumn': 'ç§‹',
                'winter': 'å†¬'
            };
            return names[theme] || theme;
        }

        // ç”»åƒç®¡ç†æ©Ÿèƒ½
        
        // ç”»åƒæŒ¿å…¥é–¢æ•°
        function insertImage(imageUrl, altText = '') {
            try {
                const range = quill.getSelection();
                if (range) {
                    quill.insertEmbed(range.index, 'image', imageUrl);
                    quill.setSelection(range.index + 1);
                } else {
                    // ã‚«ãƒ¼ã‚½ãƒ«ä½ç½®ãŒãªã„å ´åˆã¯æœ«å°¾ã«æŒ¿å…¥
                    const length = quill.getLength();
                    quill.insertEmbed(length - 1, 'image', imageUrl);
                }
                
                updateStatus(`ğŸ“· ç”»åƒã‚’æŒ¿å…¥ã—ã¾ã—ãŸ: ${altText || 'image'}`);
                console.log('ğŸ“· [QuillBridge] ç”»åƒæŒ¿å…¥å®Œäº†:', imageUrl);
            } catch (error) {
                updateStatus(`âŒ ç”»åƒæŒ¿å…¥ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                console.log('âŒ [QuillBridge] ç”»åƒæŒ¿å…¥ã‚¨ãƒ©ãƒ¼:', error);
            }
        }

        // è¤‡æ•°ç”»åƒã®ä¸€æ‹¬æŒ¿å…¥
        function insertMultipleImages(images) {
            try {
                images.forEach((img, index) => {
                    setTimeout(() => {
                        insertImage(img.url, img.altText);
                    }, index * 100); // å°‘ã—é–“éš”ã‚’ç©ºã‘ã¦æŒ¿å…¥
                });
                
                updateStatus(`ğŸ“· ${images.length}æšã®ç”»åƒã‚’æŒ¿å…¥ã—ã¾ã—ãŸ`);
            } catch (error) {
                updateStatus(`âŒ è¤‡æ•°ç”»åƒæŒ¿å…¥ã‚¨ãƒ©ãƒ¼: ${error.message}`);
                console.log('âŒ [QuillBridge] è¤‡æ•°ç”»åƒæŒ¿å…¥ã‚¨ãƒ©ãƒ¼:', error);
            }
        }

        // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—å¯¾å¿œ
        function setupDragAndDrop() {
            const editorContainer = document.getElementById('quill-editor');
            
            editorContainer.addEventListener('dragover', (e) => {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'copy';
                editorContainer.classList.add('drag-over');
            });

            editorContainer.addEventListener('dragleave', (e) => {
                e.preventDefault();
                editorContainer.classList.remove('drag-over');
            });

            editorContainer.addEventListener('drop', async (e) => {
                e.preventDefault();
                editorContainer.classList.remove('drag-over');
                
                const files = Array.from(e.dataTransfer.files);
                const imageFiles = files.filter(file => file.type.startsWith('image/'));
                
                if (imageFiles.length > 0) {
                    updateStatus(`ğŸ“· ${imageFiles.length}æšã®ç”»åƒãŒãƒ‰ãƒ­ãƒƒãƒ—ã•ã‚Œã¾ã—ãŸ`);
                    
                    // Flutterå´ã«ãƒ‰ãƒ­ãƒƒãƒ—ã•ã‚ŒãŸç”»åƒã®å‡¦ç†ã‚’ä¾é ¼
                    try {
                        window.parent.postMessage({
                            type: 'IMAGE_DROPPED',
                            fileCount: imageFiles.length
                        }, '*');
                    } catch (e) {
                        console.log('âŒ [QuillBridge] ãƒ‰ãƒ­ãƒƒãƒ—é€šçŸ¥ã‚¨ãƒ©ãƒ¼:', e);
                        updateStatus('âŒ ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½ã¯é–‹ç™ºä¸­ã§ã™');
                    }
                } else {
                    updateStatus('âŒ ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ãƒ‰ãƒ­ãƒƒãƒ—ã§ãã¾ã™');
                }
            });
        }

        // Flutter â†” JavaScript Bridgeæ©Ÿèƒ½
        
        // HTMLå½¢å¼ã§å†…å®¹ã‚’å–å¾—
        function getHtmlContent() {
            const html = quill.root.innerHTML;
            updateStatus(`HTMLå–å¾—å®Œäº† (${html.length}æ–‡å­—)`);
            
            // Flutterå´ã«é€šçŸ¥ï¼ˆHtmlElementViewå¯¾å¿œï¼‰
            if (window.parent && window.parent.onQuillHtmlChanged) {
                window.parent.onQuillHtmlChanged(html);
            }
            
            return html;
        }
        
        // Deltaå½¢å¼ã§å†…å®¹ã‚’å–å¾—
        function getDeltaContent() {
            const delta = quill.getContents();
            const deltaJson = JSON.stringify(delta);
            updateStatus(`Deltaå–å¾—å®Œäº† (${deltaJson.length}æ–‡å­—)`);
            
            // Flutterå´ã«é€šçŸ¥ï¼ˆHtmlElementViewå¯¾å¿œï¼‰
            try {
                if (window.parent && window.parent.onQuillDeltaChanged) {
                    window.parent.onQuillDeltaChanged(deltaJson);
                }
            } catch (e) {
                console.log('ğŸ”— [QuillBridge] Deltaé€šçŸ¥ã‚¨ãƒ©ãƒ¼:', e);
            }
            
            return delta;
        }
        
        // å†…å®¹ã‚’è¨­å®šï¼ˆHTML or Deltaï¼‰
        function setContent(content, format = 'html') {
            try {
                if (format === 'html') {
                    quill.root.innerHTML = content || '';
                } else if (format === 'delta') {
                    const delta = typeof content === 'string' ? JSON.parse(content) : content;
                    quill.setContents(delta);
                }
                updateStatus(`å†…å®¹è¨­å®šå®Œäº† (${format}å½¢å¼)`);
            } catch (error) {
                updateStatus(`âŒ å†…å®¹è¨­å®šã‚¨ãƒ©ãƒ¼: ${error.message}`);
            }
        }
        
        // å†…å®¹ã‚’ã‚¯ãƒªã‚¢
        function clearContent() {
            quill.setText('');
            updateStatus('å†…å®¹ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
        }
        
        // PDFå‡ºåŠ›ï¼ˆå°†æ¥å®Ÿè£…ï¼‰
        function exportPdf() {
            updateStatus('ğŸ“„ PDFå‡ºåŠ›æ©Ÿèƒ½ã¯å®Ÿè£…äºˆå®šã§ã™');
            
            // Flutterå´ã«PDFå‡ºåŠ›è¦æ±‚ã‚’é€ä¿¡ï¼ˆHtmlElementViewå¯¾å¿œï¼‰
            try {
                if (window.parent && window.parent.onQuillPdfRequest) {
                    const html = getHtmlContent();
                    window.parent.onQuillPdfRequest(html);
                }
            } catch (e) {
                console.log('ğŸ”— [QuillBridge] PDFè¦æ±‚ã‚¨ãƒ©ãƒ¼:', e);
            }
        }
        
        // ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
        function updateStatus(message) {
            const statusEl = document.getElementById('status');
            statusEl.textContent = message;
            
            // 3ç§’å¾Œã«å…ƒã«æˆ»ã™
            setTimeout(() => {
                statusEl.textContent = 'âœ… Quill.js ã‚¨ãƒ‡ã‚£ã‚¿æº–å‚™å®Œäº† - å­¦ç´šé€šä¿¡ã‚’ç·¨é›†ã—ã¦ãã ã•ã„';
            }, 3000);
        }
        
        // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¤‰æ›´æ¤œçŸ¥
        quill.on('text-change', function(delta, oldDelta, source) {
            if (source === 'user') {
                const html = quill.root.innerHTML;
                const wordCount = quill.getText().length;
                
                // Flutterå´ã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°ã‚’é€šçŸ¥ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãªæ–‡å­—åˆ—å½¢å¼ï¼‰
                try {
                    window.parent.postMessage('QUILL_HTML:' + html, '*');
                } catch (e) {
                    console.log('ğŸ”— [QuillBridge] Flutteré€šä¿¡ã‚¨ãƒ©ãƒ¼:', e);
                }
            }
        });
        
        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å—ä¿¡ãƒãƒ³ãƒ‰ãƒ©
        window.addEventListener('message', function(event) {
            try {
                const message = event.data;
                
                // ç”»åƒæŒ¿å…¥ã‚³ãƒãƒ³ãƒ‰ã®å‡¦ç†
                if (message && typeof message === 'object') {
                    if (message.type === 'INSERT_IMAGE') {
                        insertImage(message.url, message.altText);
                        return;
                    } else if (message.type === 'INSERT_MULTIPLE_IMAGES') {
                        insertMultipleImages(message.images);
                        return;
                    }
                }
                
                // EXECã‚³ãƒãƒ³ãƒ‰ã®å‡¦ç†
                if (typeof message === 'string' && message.startsWith('EXEC:')) {
                    const script = message.substring(5);
                    eval(script);
                }
            } catch (e) {
                console.log('âŒ [QuillBridge] ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å‡¦ç†ã‚¨ãƒ©ãƒ¼:', e);
            }
        });
        
        // Flutterå´ã‹ã‚‰ã®é–¢æ•°å‘¼ã³å‡ºã—ç”¨ï¼ˆGlobalé–¢æ•°ã¨ã—ã¦å…¬é–‹ï¼‰
        window.quillSetContent = setContent;
        window.quillGetHtml = function() {
            const html = quill.root.innerHTML;
            window.parent.postMessage('QUILL_HTML:' + html, '*');
            return html;
        };
        window.quillGetDelta = function() {
            const delta = quill.getContents();
            return JSON.stringify(delta);
        };
        window.quillClear = clearContent;
        window.quillSwitchTheme = switchTheme;
        window.quillInsertImage = insertImage;
        window.quillInsertMultipleImages = insertMultipleImages;
        
        // åˆæœŸåŒ–å®Œäº†ã‚’é€šçŸ¥
        window.addEventListener('load', function() {
            updateStatus('âœ… Quill.js ã‚¨ãƒ‡ã‚£ã‚¿åˆæœŸåŒ–å®Œäº†');
            
            // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—æ©Ÿèƒ½ã‚’è¨­å®š
            setupDragAndDrop();
            
            // Flutterå´ã«æº–å‚™å®Œäº†ã‚’é€šçŸ¥ï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãªæ–‡å­—åˆ—å½¢å¼ï¼‰
            try {
                window.parent.postMessage('QUILL_READY', '*');
            } catch (e) {
                console.log('ğŸ”— [QuillBridge] åˆæœŸåŒ–é€šçŸ¥ã‚¨ãƒ©ãƒ¼:', e);
            }
        });
        
        console.log('ğŸ“ å­¦ç´šé€šä¿¡ Quill.js ã‚¨ãƒ‡ã‚£ã‚¿åˆæœŸåŒ–å®Œäº†');
    </script>
</body>
</html> 