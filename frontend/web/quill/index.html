<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã‚†ã¨ã‚Šè·å“¡å®¤ - ã‚°ãƒ©ãƒ•ã‚£ãƒƒã‚¯ãƒ¬ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°é¢¨ã‚¨ãƒ‡ã‚£ã‚¿</title>
    
    <!-- Quill.js CSS -->
    <link href="https://cdn.quilljs.com/1.3.7/quill.snow.css" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Hiragino Sans', 'ãƒ’ãƒ©ã‚®ãƒè§’ã‚´ã‚·ãƒƒã‚¯', 'Yu Gothic', 'æ¸¸ã‚´ã‚·ãƒƒã‚¯', 'Meiryo UI', 'ãƒ¡ã‚¤ãƒªã‚ª', sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f8f9fa;
        }
        
        .editor-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .custom-toolbar {
            border-bottom: 1px solid #e0e0e0;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .custom-toolbar .ql-toolbar.ql-snow {
            border: none;
            padding: 0;
        }
        
        .custom-toolbar .ql-toolbar.ql-snow .ql-picker-label {
            color: white;
        }
        
        .custom-toolbar .ql-toolbar.ql-snow .ql-stroke {
            stroke: white;
        }
        
        .custom-toolbar .ql-toolbar.ql-snow .ql-fill {
            fill: white;
        }
        
        .custom-toolbar .ql-toolbar.ql-snow button:hover {
            background-color: rgba(255, 255, 255, 0.2);
        }
        
        #editor {
            height: 600px;
            font-size: 16px;
            line-height: 1.8;
            border: none;
        }
        
        .ql-editor {
            padding: 30px;
        }
        
        .ql-editor h1, .ql-editor h2, .ql-editor h3 {
            color: #2c3e50;
            margin-top: 30px;
            margin-bottom: 15px;
        }
        
        .ql-editor h1 {
            font-size: 2.2em;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        
        .ql-editor h2 {
            font-size: 1.8em;
            color: #e74c3c;
        }
        
        .ql-editor h3 {
            font-size: 1.4em;
            color: #f39c12;
        }
        
        .ql-editor p {
            margin-bottom: 15px;
        }
        
        .ql-editor strong {
            color: #2c3e50;
            font-weight: 700;
        }
        
        .ql-editor blockquote {
            border-left: 4px solid #3498db;
            padding-left: 20px;
            margin: 20px 0;
            background-color: #f8f9fa;
            font-style: italic;
        }
        
        /* å­£ç¯€ãƒ†ãƒ¼ãƒã‚«ãƒ©ãƒ¼å¤‰æ•° */
        :root {
            --primary-color: #3498db;
            --secondary-color: #2ecc71;
            --accent-color: #f39c12;
            --danger-color: #e74c3c;
        }
        
        /* æ˜¥ãƒ†ãƒ¼ãƒï¼ˆæ¡œã®å­£ç¯€ï¼‰ */
        .spring-theme {
            --primary: #ff9eaa;     /* æ¡œè‰² */
            --secondary: #a5d8ff;   /* æ˜¥ã®ç©ºè‰² */
            --accent: #ffdb4d;      /* èœã®èŠ±è‰² */
            --background: #f8f9fa;  /* æ˜ã‚‹ã„èƒŒæ™¯ */
            --text: #343a40;        /* æ¨™æº–ãƒ†ã‚­ã‚¹ãƒˆè‰² */
            --heading: #e64980;     /* è¦‹å‡ºã—è‰² */
            --link: #4c6ef5;        /* ãƒªãƒ³ã‚¯è‰² */
            --border: #dee2e6;      /* å¢ƒç•Œç·šè‰² */
        }
        
        .spring-theme .ql-editor {
            background-color: var(--background);
            color: var(--text);
        }
        
        .spring-theme .ql-editor h1,
        .spring-theme .ql-editor h2,
        .spring-theme .ql-editor h3 {
            color: var(--heading);
        }
        
        .spring-theme .ql-editor h1 {
            border-bottom-color: var(--secondary);
        }
        
        .spring-theme .ql-editor blockquote {
            border-left-color: var(--accent);
            background-color: var(--background);
        }
        
        /* å¤ãƒ†ãƒ¼ãƒï¼ˆç·‘ã®å­£ç¯€ï¼‰ */
        .summer-theme {
            --primary: #51cf66;     /* è‹¥è‘‰è‰² */
            --secondary: #339af0;   /* å¤ç©ºè‰² */
            --accent: #ff922b;      /* å¤ªé™½è‰² */
            --background: #f1f8ff;  /* æ¶¼ã—ã’ãªèƒŒæ™¯ */
            --text: #1a1c20;        /* æ¿ƒã„ãƒ†ã‚­ã‚¹ãƒˆè‰² */
            --heading: #20c997;     /* è¦‹å‡ºã—è‰² */
            --link: #1971c2;        /* ãƒªãƒ³ã‚¯è‰² */
            --border: #e7f5ff;      /* å¢ƒç•Œç·šè‰² */
        }
        
        .summer-theme .ql-editor {
            background-color: var(--background);
            color: var(--text);
        }
        
        .summer-theme .ql-editor h1,
        .summer-theme .ql-editor h2,
        .summer-theme .ql-editor h3 {
            color: var(--heading);
        }
        
        .summer-theme .ql-editor h1 {
            border-bottom-color: var(--secondary);
        }
        
        .summer-theme .ql-editor blockquote {
            border-left-color: var(--accent);
            background-color: var(--background);
        }
        
        /* ç§‹ãƒ†ãƒ¼ãƒï¼ˆç´…è‘‰ã®å­£ç¯€ï¼‰ */
        .autumn-theme {
            --primary: #e67700;     /* ç´…è‘‰è‰² */
            --secondary: #d9480f;   /* æ·±ç´…è‰² */
            --accent: #fff3bf;      /* ç©ã‚„ã‹ãªé»„è‰² */
            --background: #fff9db;  /* å„ªã—ã„èƒŒæ™¯ */
            --text: #2b2a29;        /* æ·±ã¿ã®ã‚ã‚‹ãƒ†ã‚­ã‚¹ãƒˆè‰² */
            --heading: #c92a2a;     /* è¦‹å‡ºã—è‰² */
            --link: #a61e4d;        /* ãƒªãƒ³ã‚¯è‰² */
            --border: #ffe8cc;      /* å¢ƒç•Œç·šè‰² */
        }
        
        .autumn-theme .ql-editor {
            background-color: var(--background);
            color: var(--text);
        }
        
        .autumn-theme .ql-editor h1,
        .autumn-theme .ql-editor h2,
        .autumn-theme .ql-editor h3 {
            color: var(--heading);
        }
        
        .autumn-theme .ql-editor h1 {
            border-bottom-color: var(--secondary);
        }
        
        .autumn-theme .ql-editor blockquote {
            border-left-color: var(--accent);
            background-color: var(--background);
        }
        
        /* å†¬ãƒ†ãƒ¼ãƒï¼ˆé›ªã®å­£ç¯€ï¼‰ */
        .winter-theme {
            --primary: #4dabf7;     /* å†¬ç©ºè‰² */
            --secondary: #e7f5ff;   /* é›ªè‰² */
            --accent: #91a7ff;      /* è–„ç´«è‰² */
            --background: #f8f9fa;  /* ç™½ã„èƒŒæ™¯ */
            --text: #1a1c20;        /* æ¿ƒã„ãƒ†ã‚­ã‚¹ãƒˆè‰² */
            --heading: #1864ab;     /* è¦‹å‡ºã—è‰² */
            --link: #5f3dc4;        /* ãƒªãƒ³ã‚¯è‰² */
            --border: #d0ebff;      /* å¢ƒç•Œç·šè‰² */
        }
        
        .winter-theme .ql-editor {
            background-color: var(--background);
            color: var(--text);
        }
        
        .winter-theme .ql-editor h1,
        .winter-theme .ql-editor h2,
        .winter-theme .ql-editor h3 {
            color: var(--heading);
        }
        
        .winter-theme .ql-editor h1 {
            border-bottom-color: var(--secondary);
        }
        
        .winter-theme .ql-editor blockquote {
            border-left-color: var(--accent);
            background-color: var(--background);
        }
        
        /* ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ã®ãƒ†ãƒ¼ãƒå¯¾å¿œ */
        .ql-toolbar {
            background-color: var(--background, #ffffff);
            border-color: var(--border, #ccc);
        }
        
        .ql-container {
            border-color: var(--border, #ccc);
        }
        
        /* ãƒªãƒ³ã‚¯ã‚¹ã‚¿ã‚¤ãƒ« */
        .ql-editor a {
            color: var(--link);
        }
        
        /* ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£å¯¾å¿œï¼ˆé«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆï¼‰ */
        @media (prefers-contrast: high) {
            .ql-editor {
                color: #000000 !important;
                background-color: #ffffff !important;
            }
            
            .ql-editor h1,
            .ql-editor h2,
            .ql-editor h3 {
                color: #000000 !important;
            }
        }

        /* å­¦ç´šé€šä¿¡å°‚ç”¨ãƒ„ãƒ¼ãƒ«ã®ã‚¹ã‚¿ã‚¤ãƒ« */
        .custom-education-tools {
            border-left: 1px solid #ccc;
            padding-left: 8px;
            margin-left: 8px;
        }

        .custom-btn {
            background: none;
            border: none;
            padding: 6px 8px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 16px;
            transition: background-color 0.2s;
        }

        .custom-btn:hover {
            background-color: var(--background, #f0f0f0);
        }

        .custom-btn:active {
            background-color: var(--secondary, #e0e0e0);
        }

        /* ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ã®ãƒ’ãƒ³ãƒˆè¡¨ç¤º */
        .shortcut-hint {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            pointer-events: none;
            z-index: 1000;
            transform: translateY(-100%);
            margin-top: -5px;
        }

        /* æ—¥æœ¬èªå…¥åŠ›æ™‚ã®IMEå¯¾å¿œ */
        .ql-editor {
            ime-mode: active;
        }

        /* ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ãƒœã‚¿ãƒ³ã®æ—¥æœ¬èªãƒ©ãƒ™ãƒ«å¼·åŒ– */
        .ql-toolbar button::after,
        .ql-toolbar select::after {
            font-size: 11px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="editor-container">
        <div class="custom-toolbar">
            <div id="toolbar">
                <!-- åŸºæœ¬ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ -->
                <span class="ql-formats">
                    <select class="ql-font" title="ãƒ•ã‚©ãƒ³ãƒˆ">
                        <option selected>æ¨™æº–ãƒ•ã‚©ãƒ³ãƒˆ</option>
                        <option value="serif">æ˜æœä½“</option>
                        <option value="monospace">ç­‰å¹…ãƒ•ã‚©ãƒ³ãƒˆ</option>
                    </select>
                    <select class="ql-size" title="æ–‡å­—ã‚µã‚¤ã‚º">
                        <option value="small">å°</option>
                        <option selected>æ¨™æº–</option>
                        <option value="large">å¤§</option>
                        <option value="huge">ç‰¹å¤§</option>
                    </select>
                </span>
                
                <!-- è¦‹å‡ºã— -->
                <span class="ql-formats">
                    <select class="ql-header" title="è¦‹å‡ºã—">
                        <option selected>æœ¬æ–‡</option>
                        <option value="1">å¤§è¦‹å‡ºã—</option>
                        <option value="2">ä¸­è¦‹å‡ºã—</option>
                        <option value="3">å°è¦‹å‡ºã—</option>
                    </select>
                </span>
                
                <!-- ãƒ†ã‚­ã‚¹ãƒˆè£…é£¾ -->
                <span class="ql-formats">
                    <button class="ql-bold" title="å¤ªå­— (Ctrl+B)"></button>
                    <button class="ql-italic" title="æ–œä½“ (Ctrl+I)"></button>
                    <button class="ql-underline" title="ä¸‹ç·š (Ctrl+U)"></button>
                    <button class="ql-strike" title="å–ã‚Šæ¶ˆã—ç·š"></button>
                </span>
                
                <!-- ã‚«ãƒ©ãƒ¼ -->
                <span class="ql-formats">
                    <select class="ql-color" title="æ–‡å­—è‰²"></select>
                    <select class="ql-background" title="èƒŒæ™¯è‰²"></select>
                </span>
                
                <!-- æ–‡ç« æ§‹æˆ -->
                <span class="ql-formats">
                    <button class="ql-blockquote" title="å¼•ç”¨ (å­¦ç¿’ã®ãƒã‚¤ãƒ³ãƒˆ)"></button>
                    <button class="ql-code-block" title="ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯"></button>
                </span>
                
                <!-- ãƒªã‚¹ãƒˆ -->
                <span class="ql-formats">
                    <button class="ql-list" value="ordered" title="ç•ªå·ä»˜ããƒªã‚¹ãƒˆ"></button>
                    <button class="ql-list" value="bullet" title="ç®‡æ¡æ›¸ããƒªã‚¹ãƒˆ"></button>
                    <button class="ql-indent" value="-1" title="ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ¸›"></button>
                    <button class="ql-indent" value="+1" title="ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆå¢—"></button>
                </span>
                
                <!-- æ–‡å­—æƒãˆ -->
                <span class="ql-formats">
                    <select class="ql-align" title="æ–‡å­—æƒãˆ">
                        <option selected></option>
                        <option value="center">ä¸­å¤®</option>
                        <option value="right">å³æƒãˆ</option>
                        <option value="justify">ä¸¡ç«¯æƒãˆ</option>
                    </select>
                </span>
                
                <!-- ãƒªãƒ³ã‚¯ãƒ»ç”»åƒ -->
                <span class="ql-formats">
                    <button class="ql-link" title="ãƒªãƒ³ã‚¯"></button>
                    <button class="ql-image" title="ç”»åƒæŒ¿å…¥"></button>
                </span>
                
                <!-- å­¦ç´šé€šä¿¡å°‚ç”¨æ©Ÿèƒ½ -->
                <span class="ql-formats custom-education-tools">
                    <button class="custom-btn" id="insert-date" title="ä»Šæ—¥ã®æ—¥ä»˜æŒ¿å…¥ (Ctrl+D)">ğŸ“…</button>
                    <button class="custom-btn" id="insert-greeting" title="å­£ç¯€ã®æŒ¨æ‹¶æ–‡ (Ctrl+G)">ğŸŒ¸</button>
                    <button class="custom-btn" id="insert-subjects" title="æ•™ç§‘ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ (Ctrl+T)">ğŸ“š</button>
                    <button class="custom-btn" id="insert-homework" title="å®¿é¡Œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ (Ctrl+H)">ğŸ“</button>
                </span>
                
                <!-- ç·¨é›†æ©Ÿèƒ½ */
                <span class="ql-formats">
                    <button class="ql-clean" title="æ›¸å¼ã‚¯ãƒªã‚¢"></button>
                </span>
            </div>
        </div>
        
        <div id="editor">
            <h1>å­¦ç´šé€šä¿¡ã‚¿ã‚¤ãƒˆãƒ«</h1>
            <p>ã“ã¡ã‚‰ã«å­¦ç´šé€šä¿¡ã®å†…å®¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚</p>
            <p>å³å´ã®AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆãƒ‘ãƒãƒ«ã‹ã‚‰éŸ³å£°å…¥åŠ›ã‚„AIæ–‡ç« ç”Ÿæˆæ©Ÿèƒ½ã‚’ã”åˆ©ç”¨ã„ãŸã ã‘ã¾ã™ã€‚</p>
            
            <h2>ä»Šæ—¥ã®å­¦ç¿’å†…å®¹</h2>
            <ul>
                <li>å›½èªï¼šç‰©èªã®èª­è§£</li>
                <li>ç®—æ•°ï¼šåˆ†æ•°ã®è¨ˆç®—</li>
                <li>ç†ç§‘ï¼šæ¤ç‰©ã®è¦³å¯Ÿ</li>
            </ul>
            
            <blockquote>
                å­ã©ã‚‚ãŸã¡ã®é ‘å¼µã‚Šã‚„æˆé•·ã‚’ä¿è­·è€…ã®çš†æ§˜ã«ãŠä¼ãˆã—ã¾ã™ã€‚
            </blockquote>
        </div>
    </div>

    <!-- Quill.js JavaScript -->
    <script src="https://cdn.quilljs.com/1.3.7/quill.min.js"></script>
    
    <script>
        // Quill.js ã‚¨ãƒ‡ã‚£ã‚¿ã®åˆæœŸåŒ–ã¨è¨­å®š
        const quill = new Quill('#editor', {
            theme: 'snow',
            placeholder: 'ä»Šæ—¥ã®å­¦ç´šé€šä¿¡ã‚’æ›¸ãã¾ã—ã‚‡ã†...',
            modules: {
                toolbar: '#toolbar'
            }
        });

        // å­¦ç´šé€šä¿¡å°‚ç”¨æ©Ÿèƒ½ã®å®Ÿè£…
        function initializeEducationTools() {
            // ä»Šæ—¥ã®æ—¥ä»˜æŒ¿å…¥
            document.getElementById('insert-date').addEventListener('click', function() {
                insertCurrentDate();
            });

            // å­£ç¯€ã®æŒ¨æ‹¶æ–‡æŒ¿å…¥
            document.getElementById('insert-greeting').addEventListener('click', function() {
                insertSeasonalGreeting();
            });

            // æ•™ç§‘ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæŒ¿å…¥
            document.getElementById('insert-subjects').addEventListener('click', function() {
                insertSubjectTemplate();
            });

            // å®¿é¡Œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæŒ¿å…¥
            document.getElementById('insert-homework').addEventListener('click', function() {
                insertHomeworkTemplate();
            });
        }

        // ä»Šæ—¥ã®æ—¥ä»˜ã‚’æŒ¿å…¥
        function insertCurrentDate() {
            const today = new Date();
            const year = today.getFullYear();
            const month = today.getMonth() + 1;
            const date = today.getDate();
            const days = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
            const day = days[today.getDay()];
            
            const dateString = `${year}å¹´${month}æœˆ${date}æ—¥ï¼ˆ${day}ï¼‰`;
            const selection = quill.getSelection();
            const index = selection ? selection.index : quill.getLength();
            quill.insertText(index, dateString);
        }

        // å­£ç¯€ã®æŒ¨æ‹¶æ–‡ã‚’æŒ¿å…¥
        function insertSeasonalGreeting() {
            const month = new Date().getMonth() + 1;
            let greeting = '';

            if (month >= 3 && month <= 5) {
                greeting = 'æš–ã‹ãªæ˜¥ã®æ—¥å·®ã—ãŒå¿ƒåœ°ã‚ˆã„å­£ç¯€ã¨ãªã‚Šã¾ã—ãŸã€‚æ–°å­¦æœŸã‚‚å§‹ã¾ã‚Šã€å­ã©ã‚‚ãŸã¡ã®å…ƒæ°—ãªå£°ãŒæ•™å®¤ã«éŸ¿ã„ã¦ã„ã¾ã™ã€‚';
            } else if (month >= 6 && month <= 8) {
                greeting = 'ç·‘è±Šã‹ãªå¤ã®å­£ç¯€ã‚’è¿ãˆã¾ã—ãŸã€‚å­ã©ã‚‚ãŸã¡ã¯å…ƒæ°—ã„ã£ã±ã„ã«å­¦ç¿’ã«å–ã‚Šçµ„ã‚“ã§ã„ã¾ã™ã€‚';
            } else if (month >= 9 && month <= 11) {
                greeting = 'ç§‹é¢¨ãŒå¿ƒåœ°ã‚ˆãã€å®Ÿã‚Šã®å­£ç¯€ã‚’è¿ãˆã¾ã—ãŸã€‚å­ã©ã‚‚ãŸã¡ã‚‚å­¦ç¿’ã«é›†ä¸­ã—ã¦å–ã‚Šçµ„ã‚“ã§ã„ã¾ã™ã€‚';
            } else {
                greeting = 'å¯’ã•ãŒå³ã—ã„å­£ç¯€ã¨ãªã‚Šã¾ã—ãŸãŒã€å­ã©ã‚‚ãŸã¡ã¯å…ƒæ°—ã«ç™»æ ¡ã—ã€å­¦ç¿’ã«åŠ±ã‚“ã§ã„ã¾ã™ã€‚';
            }

            const selection = quill.getSelection();
            const index = selection ? selection.index : quill.getLength();
            quill.insertText(index, greeting);
        }

        // æ•™ç§‘ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æŒ¿å…¥
        function insertSubjectTemplate() {
            const template = `
ã€ä»Šæ—¥ã®å­¦ç¿’å†…å®¹ã€‘

å›½èªï¼š
ç®—æ•°ï¼š
ç†ç§‘ï¼š
ç¤¾ä¼šï¼š

ã€å­¦ç¿’ã®ãƒã‚¤ãƒ³ãƒˆã€‘
ãƒ»
ãƒ»
ãƒ»
`;
            const selection = quill.getSelection();
            const index = selection ? selection.index : quill.getLength();
            quill.insertText(index, template);
        }

        // å®¿é¡Œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’æŒ¿å…¥
        function insertHomeworkTemplate() {
            const template = `
ã€ä»Šæ—¥ã®å®¿é¡Œã€‘

â–¡ æ¼¢å­—ç·´ç¿’ï¼š
â–¡ è¨ˆç®—ãƒ‰ãƒªãƒ«ï¼š
â–¡ éŸ³èª­ï¼š
â–¡ ãã®ä»–ï¼š

ã€æå‡ºæ—¥ã€‘ï¼šæ˜æ—¥
ã€æŒã¡ç‰©ã€‘ï¼š
`;
            const selection = quill.getSelection();
            const index = selection ? selection.index : quill.getLength();
            quill.insertText(index, template);
        }

        // ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼å®Ÿè£…
        function initializeShortcuts() {
            document.addEventListener('keydown', function(e) {
                // Ctrl + D: æ—¥ä»˜æŒ¿å…¥
                if (e.ctrlKey && e.key === 'd') {
                    e.preventDefault();
                    insertCurrentDate();
                }
                
                // Ctrl + G: æŒ¨æ‹¶æ–‡æŒ¿å…¥
                if (e.ctrlKey && e.key === 'g') {
                    e.preventDefault();
                    insertSeasonalGreeting();
                }
                
                // Ctrl + T: æ•™ç§‘ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæŒ¿å…¥
                if (e.ctrlKey && e.key === 't') {
                    e.preventDefault();
                    insertSubjectTemplate();
                }
                
                // Ctrl + H: å®¿é¡Œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæŒ¿å…¥
                if (e.ctrlKey && e.key === 'h') {
                    e.preventDefault();
                    insertHomeworkTemplate();
                }

                // F1: ãƒ˜ãƒ«ãƒ—è¡¨ç¤º
                if (e.key === 'F1') {
                    e.preventDefault();
                    showShortcutHelp();
                }
            });
        }

        // ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º
        function showShortcutHelp() {
            const helpText = `
ã€ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ä¸€è¦§ã€‘

åŸºæœ¬æ“ä½œï¼š
Ctrl + Bï¼šå¤ªå­—
Ctrl + Iï¼šæ–œä½“
Ctrl + Uï¼šä¸‹ç·š
Ctrl + Zï¼šå…ƒã«æˆ»ã™
Ctrl + Yï¼šã‚„ã‚Šç›´ã—

å­¦ç´šé€šä¿¡æ©Ÿèƒ½ï¼š
Ctrl + Dï¼šä»Šæ—¥ã®æ—¥ä»˜æŒ¿å…¥
Ctrl + Gï¼šå­£ç¯€ã®æŒ¨æ‹¶æ–‡æŒ¿å…¥
Ctrl + Tï¼šæ•™ç§‘ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæŒ¿å…¥
Ctrl + Hï¼šå®¿é¡Œãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæŒ¿å…¥

F1ï¼šã“ã®ãƒ˜ãƒ«ãƒ—ã‚’è¡¨ç¤º
`;
            alert(helpText);
        }

        // JavaScript Bridgeç”¨ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°ã‚’å®šç¾©
        window.quillBridge = {
            // ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œã®ãƒ¡ã‚¤ãƒ³ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
            executeCommand: function(commandJson) {
                try {
                    const command = JSON.parse(commandJson);
                    const result = window.quillBridge._handleCommand(command);
                    return JSON.stringify({
                        success: true,
                        data: result,
                        id: command.id,
                        timestamp: Date.now()
                    });
                } catch (error) {
                    return JSON.stringify({
                        success: false,
                        error: error.message,
                        id: command?.id,
                        timestamp: Date.now()
                    });
                }
            },
            
            // å†…éƒ¨ã‚³ãƒãƒ³ãƒ‰ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
            _handleCommand: function(command) {
                const { method, params } = command;
                
                switch (method) {
                    case 'getHTML':
                        return quill.root.innerHTML;
                    
                    case 'setHTML':
                        quill.root.innerHTML = params.html || '';
                        return true;
                    
                    case 'getDelta':
                        return JSON.stringify(quill.getContents());
                    
                    case 'setDelta':
                        const delta = JSON.parse(params.deltaJson);
                        quill.setContents(delta);
                        return true;
                    
                    case 'getText':
                        return quill.getText();
                    
                    case 'insertText':
                        const index = params.index !== undefined ? params.index : quill.getLength();
                        quill.insertText(index, params.text);
                        return true;
                    
                    case 'focus':
                        quill.focus();
                        return true;
                    
                    case 'getSelection':
                        const range = quill.getSelection();
                        return range ? JSON.stringify(range) : null;
                    
                    case 'setSelection':
                        quill.setSelection(params.index, params.length || 0);
                        return true;
                    
                    case 'setTheme':
                        const body = document.body;
                        body.classList.remove('spring-theme', 'summer-theme', 'autumn-theme', 'winter-theme');
                        if (params.themeName && params.themeName !== 'default') {
                            body.classList.add(params.themeName + '-theme');
                        }
                        return true;
                    
                    case 'ping':
                        return 'pong';
                    
                    default:
                        throw new Error(`Unknown command: ${method}`);
                }
            },
            
            // æ—§æ¥ã®äº’æ›æ€§ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆç›´æ¥å‘¼ã³å‡ºã—ç”¨ï¼‰
            getHTML: function() {
                return quill.root.innerHTML;
            },
            
            setHTML: function(html) {
                quill.root.innerHTML = html;
            },
            
            getDelta: function() {
                return JSON.stringify(quill.getContents());
            },
            
            setDelta: function(deltaString) {
                try {
                    const delta = JSON.parse(deltaString);
                    quill.setContents(delta);
                } catch (e) {
                    console.error('Delta parse error:', e);
                }
            },
            
            getText: function() {
                return quill.getText();
            },
            
            insertText: function(text, index) {
                index = index !== undefined ? index : quill.getLength();
                quill.insertText(index, text);
            },
            
            focus: function() {
                quill.focus();
            },
            
            getSelection: function() {
                const range = quill.getSelection();
                return range ? JSON.stringify(range) : null;
            },
            
            setSelection: function(index, length) {
                quill.setSelection(index, length || 0);
            },
            
            setTheme: function(themeName) {
                const body = document.body;
                body.classList.remove('spring-theme', 'summer-theme', 'autumn-theme', 'winter-theme');
                if (themeName && themeName !== 'default') {
                    body.classList.add(themeName + '-theme');
                }
            },
            
            ping: function() {
                return 'pong';
            }
        };
        
        // åˆæœŸåŒ–å®Œäº†ã‚’Flutterå´ã«é€šçŸ¥
        if (window.flutter_inappwebview) {
            window.flutter_inappwebview.callHandler('onQuillReady');
        }

        // æ•™è‚²ãƒ„ãƒ¼ãƒ«ã¨ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã‚­ãƒ¼ã‚’åˆæœŸåŒ–
        initializeEducationTools();
        initializeShortcuts();

        // ã‚¨ãƒ‡ã‚£ã‚¿ã®å¤‰æ›´ã‚’ç›£è¦–ã—ã¦Flutterå´ã«é€šçŸ¥ï¼ˆQuillã®åˆæœŸåŒ–å¾Œã«å®Ÿè¡Œï¼‰
        if (quill && typeof quill.on === 'function') {
            quill.on('text-change', function(delta, oldDelta, source) {
                if (source === 'user') {
                    const content = {
                        html: quill.root.innerHTML,
                        delta: JSON.stringify(quill.getContents()),
                        text: quill.getText()
                    };
                    
                    if (window.flutter_inappwebview) {
                        window.flutter_inappwebview.callHandler('onContentChange', JSON.stringify(content));
                    }
                }
            });
            
            // é¸æŠç¯„å›²å¤‰æ›´ã®é€šçŸ¥
            quill.on('selection-change', function(range, oldRange, source) {
                if (range) {
                    const selection = {
                        index: range.index,
                        length: range.length
                    };
                    
                    if (window.flutter_inappwebview) {
                        window.flutter_inappwebview.callHandler('onSelectionChange', JSON.stringify(selection));
                    }
                }
            });
        } else {
            console.error('Quill editor not properly initialized');
        }

        console.log('Quill.js editor with education tools initialized successfully');
    </script>
</body>
</html>